<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Email Extractor</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 30px;
}
.container {
  background: #fff;
  padding: 25px;
  border-radius: 8px;
  max-width: 1000px;
  margin: auto;
  box-shadow: 0 2px 10px rgba(0,0,0,.1);
}
textarea {
  width: 100%;
  height: 220px;
  font-family: monospace;
  margin-top: 10px;
}
button {
  padding: 10px 18px;
  margin-top: 10px;
  margin-right: 8px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  background: #4CAF50;
  color: #fff;
}
.secondary {
  background: #2196F3;
}
.results {
  margin-top: 20px;
  border: 1px solid #ddd;
  padding: 10px;
  background: #fafafa;
  max-height: 300px;
  overflow-y: auto;
  font-family: monospace;
  white-space: pre-wrap;
}
.stat {
  font-weight: bold;
  color: #4CAF50;
}
</style>
</head>

<body>
<div class="container">
  <h1>ðŸ“§ Simple Email Extractor</h1>
  <p>Paste any text or transaction data below.</p>

  <textarea id="input" placeholder="Paste data here..."></textarea>

  <button onclick="extractEmails()">Extract Emails</button>
  <button class="secondary" onclick="copyEmails()">Copy Emails</button>
  <button class="secondary" onclick="downloadCSV()">Download CSV</button>

  <p id="stats"></p>
  <div id="output" class="results"></div>
</div>

<script>
let emails = [];

function extractEmails() {
  const text = document.getElementById('input').value;
  const matches = text.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/g);

  emails = matches ? Array.from(new Set(matches.map(e => e.toLowerCase()))) : [];

  document.getElementById('output').textContent = emails.join('\\n');
  document.getElementById('stats').innerHTML =
    `Emails found: <span class="stat">${emails.length}</span>`;
}

function copyEmails() {
  if (!emails.length) return alert('No emails to copy.');
  navigator.clipboard.writeText(emails.join('\\n'));
  alert('Emails copied to clipboard.');
}

function downloadCSV() {
  if (!emails.length) return alert('No emails to download.');

  let csv = 'Email\\n' + emails.join('\\n');
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);

  const link = document.createElement('a');
  link.href = url;
  link.download = 'emails.csv';
  link.click();

  URL.revokeObjectURL(url);
}
</script>
</body>
</html>
